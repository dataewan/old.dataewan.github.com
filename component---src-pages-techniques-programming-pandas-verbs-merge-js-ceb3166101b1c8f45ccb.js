(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{"2iB9":function(t,n,e){"use strict";e.r(n);var d=e("q1tI"),a=e.n(d),r=e("Kvkj"),h=e("rLm2"),o=e.n(h),i=e("8ezt"),s=e.n(i),l=e("esEb"),m=e.n(l),c=e("9FBN"),u=e.n(c),g=e("4jfE"),p=e.n(g),S=e("6qPc"),b=e.n(S);var f=function(t){var n,e;function d(n){return t.call(this,n)||this}return e=t,(n=d).prototype=Object.create(e.prototype),n.prototype.constructor=n,n.__proto__=e,d.prototype.render=function(){return a.a.createElement(r.e,null,a.a.createElement(r.j,{name:"merge"},a.a.createElement(r.h,{note:a.a.createElement("a",{href:"https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.merge.html"},"pandas documentation")},"Merge is a lot like the ",a.a.createElement("span",{className:"mono"},"JOIN")," operation in SQL. You use it to join together dataframe that contain a common key. The common key is a column in each dataframe that you can use to look up between the dataframes, some sort of identifier."),a.a.createElement(r.h,{note:a.a.createElement("a",{href:"https://gist.github.com/dataewan/9e3eb3fee268b1eb4a629fd216e20712"},"where the data comes from")},"I'm going to use three dataframes for this that contain information about movies. There are dataframes named"," ",a.a.createElement("span",{className:"mono"},"movies"),","," ",a.a.createElement("span",{className:"mono"},"cast"),", and"," ",a.a.createElement("span",{className:"mono"},"crew"),"."),a.a.createElement(r.d,{caption:"Movies dataframe",fullwidth:!0},a.a.createElement(r.i,null,o.a)),a.a.createElement(r.d,{caption:"Cast dataframe",fullwidth:!0},a.a.createElement(r.i,null,s.a)),a.a.createElement(r.d,{caption:"Crew dataframe",fullwidth:!0},a.a.createElement(r.i,null,m.a)),a.a.createElement(r.h,null,"Note that there is an ",a.a.createElement("span",{className:"mono"},"id")," column in the movies dataframe. This matches the"," ",a.a.createElement("span",{className:"mono"},"movie_id")," column in the cast and crew dataframes."),a.a.createElement(r.k,{name:"Joins in pandas"},a.a.createElement(r.b,{language:"python",code:"\n(\n    # first a subquery to get all the Christopher Nolan directed films\n    crew\n    .query('job == \"Director\"')\n    .query('name == \"Christopher Nolan\"')\n    # now join with the movies and get their titles\n    .merge(\n        movies,\n        left_on='movie_id',\n        right_on='id'\n    )\n    [['title', 'release_date']]\n)\n          "}),a.a.createElement(r.i,null,u.a),a.a.createElement(r.l,{name:"left, right, inner, outer"},a.a.createElement(r.h,null,"By default pandas does an inner join. This means that only rows in both the dataframes are returned. The"," ",a.a.createElement("span",{className:"mono"},"how")," parameter lets you do different sorts of joins. This (slightly contrived) example returns any years that either Susan Sarandon or Steven Spielberg made a film. This is an outer join, because we want rows that are present in either."),a.a.createElement(r.b,{language:"python",code:"\n# get all the susan sarandon movies\nsarandon = (\n    cast\n    .query('name == \"Susan Sarandon\"')\n    .merge(movies,\n           left_on='movie_id',\n           right_on='id')\n    [['name', 'title', 'year']]\n)\n\n# get all the steven spielberg movies\nspielberg = (\n    crew\n    .query('job == \"Director\"')\n    .query('name == \"Steven Spielberg\"')\n    .merge(movies,\n           left_on='movie_id',\n           right_on='id')\n    [['name', 'title', 'year']]\n)\n\n# perform the outer join\n(\n    sarandon\n    .merge(\n        spielberg,\n        how='outer',\n        on='year',\n    )\n    [['year', 'name_x', 'name_y']]\n    .drop_duplicates()\n    .sort_values('year')\n)\n            "}),a.a.createElement(r.i,null,p.a))),a.a.createElement(r.k,{name:"Checking your merges"},a.a.createElement(r.h,null,"A nice feature introduced in pandas 0.21 is the ability to validate your merges, using the"," ",a.a.createElement("span",{className:"mono"},"validate")," parameter. Sometimes you know that there should be only one matching row in the dataframe you're joining. For example, I thought there would only be one director for each film. Putting in the validation told me that I was wrong."),a.a.createElement(r.b,{language:"python",code:"\ndirectors = (\n    crew\n    .query('job == \"Director\"')\n)\n\n(\n    movies\n    .merge(\n        directors,\n        left_on='id',\n        right_on='movie_id',\n        validate='1:1'\n    )\n)\n\n# This fails with a MergeError\n          "}),a.a.createElement(r.h,null,"That code fails. Looking into the data a bit more, I see that my assumption was incorrect. Some films have multiple directors, and"," ",a.a.createElement("a",{href:"https://en.wikipedia.org/wiki/Paris,_je_t%27aime"},"Paris, je t'aime")," ","has 21! I might have to put logic further along in my analysis to catch these cases."),a.a.createElement(r.b,{language:"python",code:"\n(\n    (\n        movies\n        .merge(\n            directors,\n            left_on='id',\n            right_on='movie_id',\n        )\n    )\n    .groupby('title')\n    .agg({'name': 'count'})\n    .sort_values('name')\n)\n          "}),a.a.createElement(r.i,null,b.a),a.a.createElement(r.h,null,"This is very useful if you are working with messy data, or if you want to apply your code to new data in the future. It helps you validate that your assumptions about the structure of the data are correct. It makes your code more resilient."))))},d}(d.Component);n.default=f},"4jfE":function(t,n){t.exports='<table border="1" class="dataframe">\n  <thead>\n    <tr style="text-align: right;">\n      <th></th>\n      <th>year</th>\n      <th>name_x</th>\n      <th>name_y</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>41</th>\n      <td>1974.0</td>\n      <td>Susan Sarandon</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>54</th>\n      <td>1975.0</td>\n      <td>NaN</td>\n      <td>Steven Spielberg</td>\n    </tr>\n    <tr>\n      <th>52</th>\n      <td>1977.0</td>\n      <td>NaN</td>\n      <td>Steven Spielberg</td>\n    </tr>\n    <tr>\n      <th>49</th>\n      <td>1979.0</td>\n      <td>NaN</td>\n      <td>Steven Spielberg</td>\n    </tr>\n    <tr>\n      <th>51</th>\n      <td>1981.0</td>\n      <td>NaN</td>\n      <td>Steven Spielberg</td>\n    </tr>\n    <tr>\n      <th>55</th>\n      <td>1982.0</td>\n      <td>NaN</td>\n      <td>Steven Spielberg</td>\n    </tr>\n    <tr>\n      <th>56</th>\n      <td>1983.0</td>\n      <td>NaN</td>\n      <td>Steven Spielberg</td>\n    </tr>\n    <tr>\n      <th>50</th>\n      <td>1984.0</td>\n      <td>NaN</td>\n      <td>Steven Spielberg</td>\n    </tr>\n    <tr>\n      <th>53</th>\n      <td>1985.0</td>\n      <td>NaN</td>\n      <td>Steven Spielberg</td>\n    </tr>\n    <tr>\n      <th>47</th>\n      <td>1989.0</td>\n      <td>NaN</td>\n      <td>Steven Spielberg</td>\n    </tr>\n    <tr>\n      <th>44</th>\n      <td>1991.0</td>\n      <td>NaN</td>\n      <td>Steven Spielberg</td>\n    </tr>\n    <tr>\n      <th>40</th>\n      <td>1992.0</td>\n      <td>Susan Sarandon</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>45</th>\n      <td>1993.0</td>\n      <td>NaN</td>\n      <td>Steven Spielberg</td>\n    </tr>\n    <tr>\n      <th>19</th>\n      <td>1994.0</td>\n      <td>Susan Sarandon</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>37</th>\n      <td>1995.0</td>\n      <td>Susan Sarandon</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>42</th>\n      <td>1997.0</td>\n      <td>NaN</td>\n      <td>Steven Spielberg</td>\n    </tr>\n    <tr>\n      <th>16</th>\n      <td>1998.0</td>\n      <td>Susan Sarandon</td>\n      <td>Steven Spielberg</td>\n    </tr>\n    <tr>\n      <th>25</th>\n      <td>1999.0</td>\n      <td>Susan Sarandon</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>27</th>\n      <td>2000.0</td>\n      <td>Susan Sarandon</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>2001.0</td>\n      <td>Susan Sarandon</td>\n      <td>Steven Spielberg</td>\n    </tr>\n    <tr>\n      <th>28</th>\n      <td>2002.0</td>\n      <td>Susan Sarandon</td>\n      <td>Steven Spielberg</td>\n    </tr>\n    <tr>\n      <th>21</th>\n      <td>2004.0</td>\n      <td>Susan Sarandon</td>\n      <td>Steven Spielberg</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>2005.0</td>\n      <td>Susan Sarandon</td>\n      <td>Steven Spielberg</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>2007.0</td>\n      <td>Susan Sarandon</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>0</th>\n      <td>2008.0</td>\n      <td>Susan Sarandon</td>\n      <td>Steven Spielberg</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>2009.0</td>\n      <td>Susan Sarandon</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>2010.0</td>\n      <td>Susan Sarandon</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>38</th>\n      <td>2011.0</td>\n      <td>Susan Sarandon</td>\n      <td>Steven Spielberg</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>2012.0</td>\n      <td>Susan Sarandon</td>\n      <td>Steven Spielberg</td>\n    </tr>\n    <tr>\n      <th>23</th>\n      <td>2013.0</td>\n      <td>Susan Sarandon</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>34</th>\n      <td>2014.0</td>\n      <td>Susan Sarandon</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>48</th>\n      <td>2015.0</td>\n      <td>NaN</td>\n      <td>Steven Spielberg</td>\n    </tr>\n    <tr>\n      <th>18</th>\n      <td>2016.0</td>\n      <td>Susan Sarandon</td>\n      <td>Steven Spielberg</td>\n    </tr>\n  </tbody>\n</table>'},"6qPc":function(t,n){t.exports='<table border="1" class="dataframe">\n  <thead>\n    <tr style="text-align: right;">\n      <th></th>\n      <th>name</th>\n    </tr>\n    <tr>\n      <th>title</th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>Bambi</th>\n      <td>7</td>\n    </tr>\n    <tr>\n      <th>Fantasia 2000</th>\n      <td>8</td>\n    </tr>\n    <tr>\n      <th>Fantasia</th>\n      <td>12</td>\n    </tr>\n    <tr>\n      <th>Movie 43</th>\n      <td>12</td>\n    </tr>\n    <tr>\n      <th>Paris, je t\'aime</th>\n      <td>21</td>\n    </tr>\n  </tbody>\n</table>'},"8ezt":function(t,n){t.exports='<table border="1" class="dataframe">\n  <thead>\n    <tr style="text-align: right;">\n      <th></th>\n      <th>cast_id</th>\n      <th>character</th>\n      <th>credit_id</th>\n      <th>gender</th>\n      <th>id</th>\n      <th>movie_id</th>\n      <th>name</th>\n      <th>order</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>242</td>\n      <td>Jake Sully</td>\n      <td>5602a8a7c3a3685532001c9a</td>\n      <td>2</td>\n      <td>65731</td>\n      <td>19995</td>\n      <td>Sam Worthington</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>3</td>\n      <td>Neytiri</td>\n      <td>52fe48009251416c750ac9cb</td>\n      <td>1</td>\n      <td>8691</td>\n      <td>19995</td>\n      <td>Zoe Saldana</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>25</td>\n      <td>Dr. Grace Augustine</td>\n      <td>52fe48009251416c750aca39</td>\n      <td>1</td>\n      <td>10205</td>\n      <td>19995</td>\n      <td>Sigourney Weaver</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>4</td>\n      <td>Col. Quaritch</td>\n      <td>52fe48009251416c750ac9cf</td>\n      <td>2</td>\n      <td>32747</td>\n      <td>19995</td>\n      <td>Stephen Lang</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>5</td>\n      <td>Trudy Chacon</td>\n      <td>52fe48009251416c750ac9d3</td>\n      <td>1</td>\n      <td>17647</td>\n      <td>19995</td>\n      <td>Michelle Rodriguez</td>\n      <td>4</td>\n    </tr>\n  </tbody>\n</table>'},"9FBN":function(t,n){t.exports='<table border="1" class="dataframe">\n  <thead>\n    <tr style="text-align: right;">\n      <th></th>\n      <th>title</th>\n      <th>release_date</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>The Dark Knight Rises</td>\n      <td>2012-07-16</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>The Dark Knight</td>\n      <td>2008-07-16</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Interstellar</td>\n      <td>2014-11-05</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Inception</td>\n      <td>2010-07-14</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Batman Begins</td>\n      <td>2005-06-10</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>Insomnia</td>\n      <td>2002-05-24</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>The Prestige</td>\n      <td>2006-10-19</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>Memento</td>\n      <td>2000-10-11</td>\n    </tr>\n  </tbody>\n</table>'},esEb:function(t,n){t.exports='<table border="1" class="dataframe">\n  <thead>\n    <tr style="text-align: right;">\n      <th></th>\n      <th>credit_id</th>\n      <th>department</th>\n      <th>gender</th>\n      <th>id</th>\n      <th>job</th>\n      <th>movie_id</th>\n      <th>name</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>52fe48009251416c750aca23</td>\n      <td>Editing</td>\n      <td>0</td>\n      <td>1721</td>\n      <td>Editor</td>\n      <td>19995</td>\n      <td>Stephen E. Rivkin</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>539c47ecc3a36810e3001f87</td>\n      <td>Art</td>\n      <td>2</td>\n      <td>496</td>\n      <td>Production Design</td>\n      <td>19995</td>\n      <td>Rick Carter</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>54491c89c3a3680fb4001cf7</td>\n      <td>Sound</td>\n      <td>0</td>\n      <td>900</td>\n      <td>Sound Designer</td>\n      <td>19995</td>\n      <td>Christopher Boyes</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>54491cb70e0a267480001bd0</td>\n      <td>Sound</td>\n      <td>0</td>\n      <td>900</td>\n      <td>Supervising Sound Editor</td>\n      <td>19995</td>\n      <td>Christopher Boyes</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>539c4a4cc3a36810c9002101</td>\n      <td>Production</td>\n      <td>1</td>\n      <td>1262</td>\n      <td>Casting</td>\n      <td>19995</td>\n      <td>Mali Finn</td>\n    </tr>\n  </tbody>\n</table>'},rLm2:function(t,n){t.exports='<table border="1" class="dataframe">\n  <thead>\n    <tr style="text-align: right;">\n      <th></th>\n      <th>budget</th>\n      <th>id</th>\n      <th>original_title</th>\n      <th>overview</th>\n      <th>popularity</th>\n      <th>release_date</th>\n      <th>runtime</th>\n      <th>status</th>\n      <th>tagline</th>\n      <th>title</th>\n      <th>vote_average</th>\n      <th>vote_count</th>\n      <th>year</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>237000000</td>\n      <td>19995</td>\n      <td>Avatar</td>\n      <td>In the 22nd century, a paraplegic Marine is di...</td>\n      <td>150.437577</td>\n      <td>2009-12-10</td>\n      <td>162.0</td>\n      <td>Released</td>\n      <td>Enter the World of Pandora.</td>\n      <td>Avatar</td>\n      <td>7.2</td>\n      <td>11800</td>\n      <td>2009.0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>300000000</td>\n      <td>285</td>\n      <td>Pirates of the Caribbean: At World\'s End</td>\n      <td>Captain Barbossa, long believed to be dead, ha...</td>\n      <td>139.082615</td>\n      <td>2007-05-19</td>\n      <td>169.0</td>\n      <td>Released</td>\n      <td>At the end of the world, the adventure begins.</td>\n      <td>Pirates of the Caribbean: At World\'s End</td>\n      <td>6.9</td>\n      <td>4500</td>\n      <td>2007.0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>245000000</td>\n      <td>206647</td>\n      <td>Spectre</td>\n      <td>A cryptic message from Bond’s past sends him o...</td>\n      <td>107.376788</td>\n      <td>2015-10-26</td>\n      <td>148.0</td>\n      <td>Released</td>\n      <td>A Plan No One Escapes</td>\n      <td>Spectre</td>\n      <td>6.3</td>\n      <td>4466</td>\n      <td>2015.0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>250000000</td>\n      <td>49026</td>\n      <td>The Dark Knight Rises</td>\n      <td>Following the death of District Attorney Harve...</td>\n      <td>112.312950</td>\n      <td>2012-07-16</td>\n      <td>165.0</td>\n      <td>Released</td>\n      <td>The Legend Ends</td>\n      <td>The Dark Knight Rises</td>\n      <td>7.6</td>\n      <td>9106</td>\n      <td>2012.0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>260000000</td>\n      <td>49529</td>\n      <td>John Carter</td>\n      <td>John Carter is a war-weary, former military ca...</td>\n      <td>43.926995</td>\n      <td>2012-03-07</td>\n      <td>132.0</td>\n      <td>Released</td>\n      <td>Lost in our world, found in another.</td>\n      <td>John Carter</td>\n      <td>6.1</td>\n      <td>2124</td>\n      <td>2012.0</td>\n    </tr>\n  </tbody>\n</table>'}}]);
//# sourceMappingURL=component---src-pages-techniques-programming-pandas-verbs-merge-js-ceb3166101b1c8f45ccb.js.map